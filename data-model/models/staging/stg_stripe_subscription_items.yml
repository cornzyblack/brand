version: 2

models:
  - name: stripe_subscription_items
    description: |
      This model extracts and transforms Stripe subscription items data.
      It handles incremental loading and includes a ranking mechanism to select
      the latest record for each subscription item.
    config:
      tags: ["third_party", "stripe"]

    columns:
      - name: subscription_item_id
        description: Unique identifier for the subscription item.
        tests:
          - unique
          - not_null
      - name: subscription_id
        description: ID of the parent subscription.
        tests:
          - not_null
      - name: subscription_status
        description: Status of the subscription (e.g., 'active', 'canceled').
      - name: created_at
        description: Timestamp of when the subscription item was created.
        tests:
          - not_null
      - name: current_period_start
        description: Start date of the current billing period.
      - name: current_period_end
        description: End date of the current billing period.
      - name: ended_at
        description: Timestamp of when the subscription item ended.
      - name: canceled_at
        description: Timestamp of when the subscription item was canceled.
      - name: tax_percent
        description: Tax percentage applied to the subscription item.
      - name: trial_start
        description: Start date of the trial period (if applicable).
      - name: trial_end
        description: End date of the trial period (if applicable).
      - name: plan_active
        description: Indicates whether the associated plan is active.
      - name: plan_interval
        description: Billing interval for the plan (e.g., 'month', 'year').
      - name: plan_id
        description: Unique identifier for the associated plan.
      - name: plan_amount
        description: Amount charged for the plan.
      - name: plan_product
        description: Product associated with the plan.
      - name: plan_interval_count
        description: Number of intervals for the billing period.
      - name: plan_billing_scheme
        description: Billing scheme for the plan (e.g., 'per_unit').
